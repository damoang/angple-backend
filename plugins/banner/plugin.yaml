# 배너 광고 플러그인
# Banner Advertising Plugin

name: banner
version: 1.0.0
title: 배너 광고
description: 위치 기반 배너 광고 시스템 (헤더, 사이드바, 콘텐츠, 푸터)
author: Damoang Team
license: MIT
homepage: https://github.com/damoang/angple-backend

# 호환성
requires:
  angple: ">=1.0.0 <2.0.0"
  go: ">=1.21"

# DB 마이그레이션
migrations:
  - file: 001_init.up.sql
    version: 1

# Hook 등록
hooks:
  - event: template.head
    handler: AddHeaderBanner
    priority: 5
    description: 헤더 영역에 배너 삽입

  - event: template.sidebar
    handler: AddSidebarBanner
    priority: 20
    description: 사이드바에 배너 삽입

  - event: template.footer
    handler: AddFooterBanner
    priority: 10
    description: 푸터 영역에 배너 삽입

  - event: post.content
    handler: InsertContentBanner
    priority: 20
    description: 글 본문에 배너 삽입

  - event: admin.menu
    handler: AddAdminMenu
    priority: 50
    description: 관리자 메뉴에 배너 관리 추가

# API 라우트
routes:
  # 공개 API
  - path: /list
    method: GET
    handler: ListBanners
    auth: none
    description: 활성 배너 목록 (위치별)

  - path: /:id/click
    method: GET
    handler: TrackClick
    auth: none
    description: 배너 클릭 트래킹 및 리다이렉트

  - path: /:id/view
    method: POST
    handler: TrackView
    auth: none
    description: 배너 노출 트래킹

  # 관리자 API
  - path: /admin/list
    method: GET
    handler: AdminListBanners
    auth: required
    description: 모든 배너 목록 (관리자)

  - path: /admin
    method: POST
    handler: CreateBanner
    auth: required
    description: 배너 추가

  - path: /admin/:id
    method: PUT
    handler: UpdateBanner
    auth: required
    description: 배너 수정

  - path: /admin/:id
    method: DELETE
    handler: DeleteBanner
    auth: required
    description: 배너 삭제

  - path: /admin/:id/stats
    method: GET
    handler: GetBannerStats
    auth: required
    description: 배너 통계 조회

# 설정 스키마
settings:
  - key: header_enabled
    type: boolean
    default: true
    label: 헤더 배너 활성화

  - key: sidebar_enabled
    type: boolean
    default: true
    label: 사이드바 배너 활성화

  - key: content_enabled
    type: boolean
    default: false
    label: 콘텐츠 배너 활성화

  - key: footer_enabled
    type: boolean
    default: false
    label: 푸터 배너 활성화

  - key: content_insert_after_paragraph
    type: number
    default: 3
    min: 1
    max: 10
    label: 콘텐츠 배너 삽입 위치
    description: 몇 번째 문단 뒤에 배너를 삽입할지

  - key: track_clicks
    type: boolean
    default: true
    label: 클릭 추적 활성화

  - key: track_views
    type: boolean
    default: true
    label: 노출 추적 활성화

# 권한 정의
permissions:
  - id: banner.manage
    label: 배너 관리
    description: 배너 생성/수정/삭제 권한

# 프론트엔드 슬롯
slots:
  - name: global.header
    component: web/components/HeaderBanner.svelte
    props: [user]
    description: 헤더 배너

  - name: global.sidebar
    component: web/components/SidebarBanner.svelte
    props: [user]
    description: 사이드바 배너

  - name: post.after_content
    component: web/components/ContentBanner.svelte
    props: [post]
    description: 콘텐츠 중간 배너
